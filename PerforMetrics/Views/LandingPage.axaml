<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:PerforMetrics.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="PerforMetrics.Views.LandingPage"
             x:DataType="vm:LandingPageViewModel">

  <Design.DataContext>
    <vm:LandingPageViewModel />
  </Design.DataContext>

  <UserControl.Resources>
    <!-- Color Resources -->
    <SolidColorBrush x:Key="BackgroundBrush" Color="#E5E7EB" />
    <SolidColorBrush x:Key="SidebarBrush" Color="#FFFFFF" />
    <SolidColorBrush x:Key="BorderBrush" Color="#D1D5DB" />
    <SolidColorBrush x:Key="TextPrimaryBrush" Color="#111827" />
    <SolidColorBrush x:Key="TextSecondaryBrush" Color="#6B7280" />
    <SolidColorBrush x:Key="SelectedBrush" Color="#EFF6FF" />
    <SolidColorBrush x:Key="HoverBrush" Color="#F3F4F6" />
    <SolidColorBrush x:Key="AccentBrush" Color="#3B82F6" />
  </UserControl.Resources>

  <UserControl.Styles>
    <!-- Menu Button Style -->
    <Style Selector="Button.menu-item">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Padding" Value="16,12" />
      <Setter Property="HorizontalAlignment" Value="Stretch" />
      <Setter Property="HorizontalContentAlignment" Value="Left" />
      <Setter Property="Cursor" Value="Hand" />
      <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}" />
      <Setter Property="FontSize" Value="14" />
    </Style>

    <Style Selector="Button.menu-item:pointerover">
      <Setter Property="Background" Value="{StaticResource HoverBrush}" />
    </Style>

    <Style Selector="Button.menu-item.selected">
      <Setter Property="Background" Value="{StaticResource SelectedBrush}" />
      <Setter Property="Foreground" Value="{StaticResource AccentBrush}" />
    </Style>

    <!-- Sidebar Bottom Button Style -->
    <Style Selector="Button.sidebar-bottom">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderThickness" Value="0" />
      <Setter Property="Padding" Value="12,8" />
      <Setter Property="HorizontalAlignment" Value="Stretch" />
      <Setter Property="HorizontalContentAlignment" Value="Left" />
      <Setter Property="Cursor" Value="Hand" />
      <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}" />
      <Setter Property="FontSize" Value="13" />
    </Style>

    <Style Selector="Button.sidebar-bottom:pointerover">
      <Setter Property="Background" Value="{StaticResource HoverBrush}" />
    </Style>
  </UserControl.Styles>

  <Grid Background="{StaticResource BackgroundBrush}">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="Auto" />
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>

    <!-- Sidebar -->
    <Border Grid.Column="0"
            Background="{StaticResource SidebarBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="0,0,1,0"
            Width="200"
            IsVisible="{Binding IsSidebarVisible}">
      <Grid RowDefinitions="Auto,*,Auto">
        
        <!-- Pipelines Section -->
        <Border Grid.Row="0" 
                Padding="16"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,0,0,1">
          <StackPanel Spacing="8">
            <TextBlock Text="Pipelines"
                       FontSize="12"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource TextSecondaryBrush}" />
            <TextBlock Text="No pipelines available"
                       FontSize="12"
                       Foreground="{StaticResource TextSecondaryBrush}" />
          </StackPanel>
        </Border>

        <!-- Menu Items -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled">
          <StackPanel Margin="8,8,8,0">
            
            <!-- Dashboard -->
            <Button x:Name="DashboardButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=Dashboard}"
                    Command="{Binding NavigateToDashboardCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Dashboard" VerticalAlignment="Center" />
              </StackPanel>
            </Button>
            
            <!-- GoPro Control -->
            <Button x:Name="GoProControlButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=GoProControl}"
                    Command="{Binding NavigateToGoProControlCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="GoPro Control" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

            <!-- Synchronization -->
            <Button x:Name="SyncButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=Synchronization}"
                    Command="{Binding NavigateToSynchronizationCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Synchronization" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

            <!-- Classification -->
            <Button x:Name="ClassificationButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=Classification}"
                    Command="{Binding NavigateToClassificationCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Classification" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

            <!-- Calibration -->
            <Button x:Name="CalibrationButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=Calibration}"
                    Command="{Binding NavigateToCalibrationCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Calibration" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

            <!-- Motion Analysis -->
            <Button x:Name="MotionButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=MotionAnalysis}"
                    Command="{Binding NavigateToMotionAnalysisCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Motion Analysis" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

            <!-- Report Generator -->
            <Button x:Name="ReportButton"
                    Classes="menu-item"
                    Classes.selected="{Binding SelectedMenuItem, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=ReportGenerator}"
                    Command="{Binding NavigateToReportGeneratorCommand}">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
                          Width="16" Height="16"
                          Foreground="{Binding $parent[Button].Foreground}" />
                <TextBlock Text="Report Generator" VerticalAlignment="Center" />
              </StackPanel>
            </Button>

          </StackPanel>
        </ScrollViewer>

        <!-- Sidebar Bottom Section -->
        <Border Grid.Row="2"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="4">
          <StackPanel>
            <Button Classes="sidebar-bottom">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <PathIcon Data="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"
                          Width="14" Height="14" />
                <TextBlock Text="User Feedback" VerticalAlignment="Center" />
              </StackPanel>
            </Button>
            
            <Button Classes="sidebar-bottom">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"
                          Width="14" Height="14" />
                <TextBlock Text="Logs" VerticalAlignment="Center" />
              </StackPanel>
            </Button>
            
            <Button Classes="sidebar-bottom"
                    Command="{Binding ToggleSidebarCommand}">
              <StackPanel Orientation="Horizontal" Spacing="8">
                <PathIcon Data="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"
                          Width="14" Height="14" />
                <TextBlock Text="Collapse" VerticalAlignment="Center" />
              </StackPanel>
            </Button>
          </StackPanel>
        </Border>

      </Grid>
    </Border>

    <!-- Main Content Area -->
    <Grid Grid.Column="1">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <!-- Header -->
      <Border Grid.Row="0"
              Background="{StaticResource SidebarBrush}"
              BorderBrush="{StaticResource BorderBrush}"
              BorderThickness="0,0,0,1"
              Height="56">
        <Grid ColumnDefinitions="Auto,*,Auto" Margin="16,0">
          
          <!-- Logo -->
          <StackPanel Grid.Column="0" 
                      Orientation="Horizontal" 
                      Spacing="12"
                      VerticalAlignment="Center">
            <Button Background="Transparent"
                    BorderThickness="0"
                    Padding="4"
                    IsVisible="{Binding !IsSidebarVisible}"
                    Command="{Binding ToggleSidebarCommand}">
              <PathIcon Data="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"
                        Width="20" Height="20"
                        Foreground="{StaticResource TextPrimaryBrush}" />
            </Button>
            
            <Image Source="/Assets/performetrics-logo.png"
                   Height="28"
                   Stretch="Uniform"
                   VerticalAlignment="Center" />
            
            <TextBlock Text="PerforMetrics"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#1E3A8A"
                       VerticalAlignment="Center" />
          </StackPanel>

          <!-- Dropdown Menu -->
          <ComboBox Grid.Column="2"
                    VerticalAlignment="Center"
                    MinWidth="180"
                    SelectedItem="{Binding SelectedProject}"
                    ItemsSource="{Binding ProjectOptions}">
            <ComboBox.ItemTemplate>
              <DataTemplate>
                <TextBlock Text="{Binding}" />
              </DataTemplate>
            </ComboBox.ItemTemplate>
          </ComboBox>

        </Grid>
      </Border>

      <!-- Main Content -->
      <Border Grid.Row="1"
              Background="{StaticResource BackgroundBrush}">
        <Grid>
          <!-- Dynamic Content Area -->
          <ContentControl Content="{Binding CurrentContentView}">
            <ContentControl.ContentTemplate>
              <DataTemplate>
                <ContentControl Content="{Binding}" />
              </DataTemplate>
            </ContentControl.ContentTemplate>
          </ContentControl>

          <!-- Default Home Content -->
          <StackPanel HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Spacing="16"
                      MaxWidth="600"
                      IsVisible="{Binding CurrentContentView, Converter={x:Static ObjectConverters.IsNull}}">
            
            <!-- Status Message -->
            <TextBlock Text="{Binding MainContentMessage}"
                       FontSize="20"
                       FontWeight="Medium"
                       Foreground="{StaticResource TextPrimaryBrush}"
                       TextAlignment="Center"
                       TextWrapping="Wrap" />

            <!-- Description -->
            <TextBlock FontSize="14"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       TextAlignment="Center"
                       TextWrapping="Wrap">
              <Run Text="You can purchase a GoPro from the " />
              <Run Text="PerforMetrics Store" FontWeight="SemiBold" />
              <Run Text=". After your purchase," />
              <LineBreak />
              <Run Text="explore the " />
              <Run Text="PerforMetrics Documentation" FontWeight="SemiBold" />
              <Run Text=" for comprehensive setup tutorials to get started." />
            </TextBlock>

            <!-- Backend Status Indicator -->
            <Border Background="{StaticResource SidebarBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16,12"
                    HorizontalAlignment="Center">
              <StackPanel Orientation="Horizontal" Spacing="12">
                <Ellipse Width="12" Height="12" 
                         VerticalAlignment="Center">
                  <Ellipse.Fill>
                    <SolidColorBrush Color="{Binding IsBackendConnected, Converter={StaticResource StatusColorConverter}}" />
                  </Ellipse.Fill>
                </Ellipse>
                <TextBlock Text="{Binding BackendStatus}"
                           Foreground="{Binding IsBackendConnected, Converter={StaticResource StatusTextColorConverter}}"
                           FontSize="13"
                           VerticalAlignment="Center" />
              </StackPanel>
            </Border>

          </StackPanel>
        </Grid>
      </Border>

    </Grid>

  </Grid>

</UserControl>
